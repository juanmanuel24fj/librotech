{"ast":null,"code":"import { Libro } from '../model/libro.model';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../services/libro.service\";\nimport * as i2 from \"../services/reserva.service\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"@angular/forms\";\nfunction LibrosComponent_div_20_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵelement(1, \"div\", 13);\n    i0.ɵɵelementStart(2, \"div\", 14)(3, \"h3\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"p\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"p\");\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(9, \"img\", 15);\n    i0.ɵɵelementStart(10, \"button\", 9);\n    i0.ɵɵlistener(\"click\", function LibrosComponent_div_20_Template_button_click_10_listener() {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r4 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r4.reservarLibro(ctx_r4.libroBuscado));\n    });\n    i0.ɵɵtext(11, \"Reservar\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"button\", 16);\n    i0.ɵɵlistener(\"click\", function LibrosComponent_div_20_Template_button_click_12_listener() {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r6 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r6.volverALibros());\n    });\n    i0.ɵɵtext(13, \"Volver a la lista\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(ctx_r0.libroBuscado.titulo);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Autor: \", ctx_r0.libroBuscado.autor, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Ejemplares disponibles: \", ctx_r0.libroBuscado.ejemplaresDisponibles, \"\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵpropertyInterpolate(\"alt\", ctx_r0.libroBuscado.titulo);\n    i0.ɵɵproperty(\"src\", ctx_r0.getImagenUrl(ctx_r0.libroBuscado.imagen), i0.ɵɵsanitizeUrl);\n  }\n}\nfunction LibrosComponent_div_21_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r10 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 19)(1, \"div\", 20);\n    i0.ɵɵelement(2, \"img\", 21);\n    i0.ɵɵelementStart(3, \"div\", 22)(4, \"h5\", 23);\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"p\", 24);\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"p\", 24);\n    i0.ɵɵtext(9);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"button\", 9);\n    i0.ɵɵlistener(\"click\", function LibrosComponent_div_21_div_1_Template_button_click_10_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r10);\n      const libro_r8 = restoredCtx.$implicit;\n      const ctx_r9 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r9.reservarLibro(libro_r8));\n    });\n    i0.ɵɵtext(11, \"Reservar\");\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    const libro_r8 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵpropertyInterpolate(\"alt\", libro_r8.titulo);\n    i0.ɵɵproperty(\"src\", \"http://localhost:8086/api/libros/images/\" + libro_r8.imagen, i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(libro_r8.titulo);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Autor: \", libro_r8.autor, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Ejemplares Disponibles: \", libro_r8.ejemplaresDisponibles, \"\");\n  }\n}\nfunction LibrosComponent_div_21_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 17);\n    i0.ɵɵtemplate(1, LibrosComponent_div_21_div_1_Template, 12, 5, \"div\", 18);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.libros);\n  }\n}\nfunction LibrosComponent_div_22_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\")(1, \"p\");\n    i0.ɵɵtext(2, \"No se encontraron libros.\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction LibrosComponent_div_23_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r12 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\")(1, \"div\", 25);\n    i0.ɵɵlistener(\"click\", function LibrosComponent_div_23_Template_div_click_1_listener() {\n      i0.ɵɵrestoreView(_r12);\n      const ctx_r11 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r11.cerrarFormularioAgregar());\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(2, \"div\", 26)(3, \"div\", 27)(4, \"span\", 28);\n    i0.ɵɵlistener(\"click\", function LibrosComponent_div_23_Template_span_click_4_listener() {\n      i0.ɵɵrestoreView(_r12);\n      const ctx_r13 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r13.cerrarFormularioAgregar());\n    });\n    i0.ɵɵtext(5, \"\\u00D7\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"h2\");\n    i0.ɵɵtext(7, \"Agregar Nuevo Libro\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"form\", 29);\n    i0.ɵɵlistener(\"ngSubmit\", function LibrosComponent_div_23_Template_form_ngSubmit_8_listener() {\n      i0.ɵɵrestoreView(_r12);\n      const ctx_r14 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r14.agregarLibro());\n    });\n    i0.ɵɵelementStart(9, \"div\", 5)(10, \"label\", 30);\n    i0.ɵɵtext(11, \"T\\u00EDtulo\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"input\", 31);\n    i0.ɵɵlistener(\"ngModelChange\", function LibrosComponent_div_23_Template_input_ngModelChange_12_listener($event) {\n      i0.ɵɵrestoreView(_r12);\n      const ctx_r15 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r15.nuevoLibro.titulo = $event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(13, \"div\", 5)(14, \"label\", 32);\n    i0.ɵɵtext(15, \"Autor\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(16, \"input\", 33);\n    i0.ɵɵlistener(\"ngModelChange\", function LibrosComponent_div_23_Template_input_ngModelChange_16_listener($event) {\n      i0.ɵɵrestoreView(_r12);\n      const ctx_r16 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r16.nuevoLibro.autor = $event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(17, \"div\", 5)(18, \"label\", 34);\n    i0.ɵɵtext(19, \"Ejemplares Disponibles\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(20, \"input\", 35);\n    i0.ɵɵlistener(\"ngModelChange\", function LibrosComponent_div_23_Template_input_ngModelChange_20_listener($event) {\n      i0.ɵɵrestoreView(_r12);\n      const ctx_r17 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r17.nuevoLibro.ejemplaresDisponibles = $event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(21, \"div\", 5)(22, \"label\", 36);\n    i0.ɵɵtext(23, \"Imagen\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(24, \"input\", 37);\n    i0.ɵɵlistener(\"change\", function LibrosComponent_div_23_Template_input_change_24_listener($event) {\n      i0.ɵɵrestoreView(_r12);\n      const ctx_r18 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r18.onFileSelected($event));\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(25, \"button\", 38);\n    i0.ɵɵtext(26, \"Agregar\");\n    i0.ɵɵelementEnd()()()()();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(12);\n    i0.ɵɵproperty(\"ngModel\", ctx_r3.nuevoLibro.titulo);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngModel\", ctx_r3.nuevoLibro.autor);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngModel\", ctx_r3.nuevoLibro.ejemplaresDisponibles);\n  }\n}\nexport class LibrosComponent {\n  constructor(libroService, reservaService, router, cdr // Inyecta ChangeDetectorRef\n  ) {\n    this.libroService = libroService;\n    this.reservaService = reservaService;\n    this.router = router;\n    this.cdr = cdr;\n    this.libros = [];\n    this.nombreBusqueda = '';\n    this.mostrarFormulario = false;\n    this.nuevoLibro = new Libro(0, '', '', 0, '');\n  }\n  ngOnInit() {\n    this.obtenerLibros();\n  }\n  obtenerLibros() {\n    this.libroService.obtenerTodosLosLibros().subscribe(libros => {\n      console.log('Todos los libros:', libros);\n      this.libros = libros;\n    }, error => {\n      console.error('Error al obtener todos los libros:', error);\n    });\n  }\n  buscarLibrosPorNombre() {\n    console.log('Buscando libros con el nombre:', this.nombreBusqueda);\n    if (this.nombreBusqueda) {\n      this.libroService.buscarLibrosPorTitulo(this.nombreBusqueda).subscribe(respuesta => {\n        const libros = Array.isArray(respuesta) ? respuesta : [respuesta];\n        console.log('Libros encontrados:', libros);\n        if (libros.length > 0) {\n          this.libroBuscado = libros[0];\n          console.log('Libro buscado actualizado:', this.libroBuscado);\n        } else {\n          this.libroBuscado = undefined;\n          console.log('No se encontraron libros con el nombre:', this.nombreBusqueda);\n        }\n      }, error => {\n        console.error('Error al buscar libros por título:', error);\n      });\n    } else {\n      this.libroBuscado = undefined;\n      this.obtenerLibros();\n    }\n  }\n  onFileSelected(event) {\n    this.selectedFile = event.target.files[0];\n  }\n  getImagenUrl(imagen) {\n    return `http://localhost:8086/api/libros/images/${imagen}`;\n  }\n  reservarLibro(libro) {\n    const usuarioId = 1; // Asigna el ID del usuario actualmente logueado\n    if (libro.ejemplaresDisponibles > 0) {\n      this.reservaService.reservarLibro(libro.id, usuarioId).subscribe(() => {\n        // Actualiza el libro de la lista\n        const libroIndex = this.libros.findIndex(l => l.id === libro.id);\n        if (libroIndex !== -1) {\n          this.libros[libroIndex].ejemplaresDisponibles--;\n          // Fuerza la detección de cambios\n          this.cdr.detectChanges();\n        }\n      }, error => {\n        console.error('Error al reservar libro:', error);\n      });\n    } else {\n      alert(`No hay ejemplares disponibles para el libro ${libro.titulo}.`);\n    }\n  }\n  mostrarFormularioAgregar() {\n    this.mostrarFormulario = true;\n  }\n  cerrarFormularioAgregar() {\n    this.mostrarFormulario = false;\n  }\n  volverALibros() {\n    this.libroBuscado = undefined;\n  }\n  agregarLibro() {\n    const formData = new FormData();\n    formData.append('libro', new Blob([JSON.stringify(this.nuevoLibro)], {\n      type: 'application/json'\n    }));\n    formData.append('imagen', this.selectedFile);\n    this.libroService.crearLibro(formData).subscribe(libro => {\n      this.libros.push(libro);\n      this.cerrarFormularioAgregar();\n    }, error => {\n      console.error('Error al agregar libro:', error);\n    });\n  }\n  static #_ = this.ɵfac = function LibrosComponent_Factory(t) {\n    return new (t || LibrosComponent)(i0.ɵɵdirectiveInject(i1.LibroService), i0.ɵɵdirectiveInject(i2.ReservaService), i0.ɵɵdirectiveInject(i3.Router), i0.ɵɵdirectiveInject(i0.ChangeDetectorRef));\n  };\n  static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: LibrosComponent,\n    selectors: [[\"app-libros\"]],\n    decls: 24,\n    vars: 5,\n    consts: [[\"lang\", \"es\"], [\"charset\", \"UTF-8\"], [\"name\", \"viewport\", \"content\", \"width=device-width, initial-scale=1.0\"], [\"href\", \"https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css\", \"rel\", \"stylesheet\"], [1, \"container\", \"mt-4\", \"libro-container\"], [1, \"mb-3\"], [\"for\", \"nombreBusqueda\", 1, \"form-label\"], [\"type\", \"text\", \"id\", \"nombreBusqueda\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [1, \"d-flex\", \"justify-content-between\", \"mt-2\"], [1, \"btn\", \"btn-primary\", 3, \"click\"], [1, \"btn\", \"btn-success\", 3, \"click\"], [4, \"ngIf\"], [\"class\", \"row\", 4, \"ngIf\"], [1, \"fondo-difuminado\"], [1, \"libro-cuadro\"], [1, \"img-fluid\", 3, \"src\", \"alt\"], [1, \"btn\", \"btn-secondary\", 3, \"click\"], [1, \"row\"], [\"class\", \"col-md-4 mb-4\", 4, \"ngFor\", \"ngForOf\"], [1, \"col-md-4\", \"mb-4\"], [1, \"card\", \"h-100\", \"card-libro\"], [1, \"card-img-top\", \"libro-imagen\", 3, \"src\", \"alt\"], [1, \"card-body\"], [1, \"card-title\"], [1, \"card-text\"], [1, \"fondo-difuminado\", 3, \"click\"], [1, \"modal\"], [1, \"modal-content\"], [1, \"close\", 3, \"click\"], [3, \"ngSubmit\"], [\"for\", \"titulo\", 1, \"form-label\"], [\"type\", \"text\", \"id\", \"titulo\", \"name\", \"titulo\", \"required\", \"\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"for\", \"autor\", 1, \"form-label\"], [\"type\", \"text\", \"id\", \"autor\", \"name\", \"autor\", \"required\", \"\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"for\", \"ejemplares\", 1, \"form-label\"], [\"type\", \"number\", \"id\", \"ejemplares\", \"name\", \"ejemplares\", \"required\", \"\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"for\", \"imagen\", 1, \"form-label\"], [\"type\", \"file\", \"id\", \"imagen\", 1, \"form-control\", 3, \"change\"], [\"type\", \"submit\", 1, \"btn\", \"btn-primary\"]],\n    template: function LibrosComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"html\", 0)(1, \"head\");\n        i0.ɵɵelement(2, \"meta\", 1)(3, \"meta\", 2);\n        i0.ɵɵelementStart(4, \"title\");\n        i0.ɵɵtext(5, \"Listado de Libros\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(6, \"link\", 3);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(7, \"body\")(8, \"div\", 4)(9, \"h2\");\n        i0.ɵɵtext(10, \"Listado de Libros\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(11, \"div\", 5)(12, \"label\", 6);\n        i0.ɵɵtext(13, \"Buscar:\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(14, \"input\", 7);\n        i0.ɵɵlistener(\"ngModelChange\", function LibrosComponent_Template_input_ngModelChange_14_listener($event) {\n          return ctx.nombreBusqueda = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(15, \"div\", 8)(16, \"button\", 9);\n        i0.ɵɵlistener(\"click\", function LibrosComponent_Template_button_click_16_listener() {\n          return ctx.buscarLibrosPorNombre();\n        });\n        i0.ɵɵtext(17, \"Buscar\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(18, \"button\", 10);\n        i0.ɵɵlistener(\"click\", function LibrosComponent_Template_button_click_18_listener() {\n          return ctx.mostrarFormularioAgregar();\n        });\n        i0.ɵɵtext(19, \"Agregar Libro\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵtemplate(20, LibrosComponent_div_20_Template, 14, 5, \"div\", 11);\n        i0.ɵɵtemplate(21, LibrosComponent_div_21_Template, 2, 1, \"div\", 12);\n        i0.ɵɵtemplate(22, LibrosComponent_div_22_Template, 3, 0, \"div\", 11);\n        i0.ɵɵtemplate(23, LibrosComponent_div_23_Template, 27, 3, \"div\", 11);\n        i0.ɵɵelementEnd()()();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(14);\n        i0.ɵɵproperty(\"ngModel\", ctx.nombreBusqueda);\n        i0.ɵɵadvance(6);\n        i0.ɵɵproperty(\"ngIf\", ctx.libroBuscado);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.libros.length > 0);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", !ctx.libros.length);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.mostrarFormulario);\n      }\n    },\n    dependencies: [i4.NgForOf, i4.NgIf, i5.ɵNgNoValidate, i5.DefaultValueAccessor, i5.NumberValueAccessor, i5.NgControlStatus, i5.NgControlStatusGroup, i5.RequiredValidator, i5.NgModel, i5.NgForm],\n    styles: [\".modal[_ngcontent-%COMP%] {\\n      display: flex;\\n      justify-content: center;\\n      align-items: center;\\n      position: fixed;\\n      top: 0;\\n      left: 0;\\n      width: 100%;\\n      height: 100%;\\n      background-color: rgba(0, 0, 0, 0.5);\\n      z-index: 1000;\\n    }\\n\\n    .modal-content[_ngcontent-%COMP%] {\\n      background-color: white;\\n      padding: 20px;\\n      border-radius: 5px;\\n      width: 500px;\\n      max-width: 100%;\\n    }\\n\\n    .close[_ngcontent-%COMP%] {\\n      position: absolute;\\n      top: 10px;\\n      right: 20px;\\n      font-size: 24px;\\n      cursor: pointer;\\n    }\\n\\n    .fondo-difuminado[_ngcontent-%COMP%] {\\n      position: fixed;\\n      top: 0;\\n      left: 0;\\n      width: 100%;\\n      height: 100%;\\n      background-color: rgba(0, 0, 0, 0.5);\\n      z-index: 999;\\n    }\\n\\n    .libro-cuadro[_ngcontent-%COMP%] {\\n      position: fixed;\\n      top: 50%;\\n      left: 50%;\\n      transform: translate(-50%, -50%);\\n      background-color: white;\\n      padding: 20px;\\n      border-radius: 5px;\\n      z-index: 1000;\\n    }\\n    .libro-imagen[_ngcontent-%COMP%] {\\n    width: 100%; \\n\\n    height: 200px; \\n\\n    object-fit: contain; \\n\\n}\"]\n  });\n}","map":{"version":3,"names":["Libro","i0","ɵɵelementStart","ɵɵelement","ɵɵtext","ɵɵelementEnd","ɵɵlistener","LibrosComponent_div_20_Template_button_click_10_listener","ɵɵrestoreView","_r5","ctx_r4","ɵɵnextContext","ɵɵresetView","reservarLibro","libroBuscado","LibrosComponent_div_20_Template_button_click_12_listener","ctx_r6","volverALibros","ɵɵadvance","ɵɵtextInterpolate","ctx_r0","titulo","ɵɵtextInterpolate1","autor","ejemplaresDisponibles","ɵɵpropertyInterpolate","ɵɵproperty","getImagenUrl","imagen","ɵɵsanitizeUrl","LibrosComponent_div_21_div_1_Template_button_click_10_listener","restoredCtx","_r10","libro_r8","$implicit","ctx_r9","ɵɵtemplate","LibrosComponent_div_21_div_1_Template","ctx_r1","libros","LibrosComponent_div_23_Template_div_click_1_listener","_r12","ctx_r11","cerrarFormularioAgregar","LibrosComponent_div_23_Template_span_click_4_listener","ctx_r13","LibrosComponent_div_23_Template_form_ngSubmit_8_listener","ctx_r14","agregarLibro","LibrosComponent_div_23_Template_input_ngModelChange_12_listener","$event","ctx_r15","nuevoLibro","LibrosComponent_div_23_Template_input_ngModelChange_16_listener","ctx_r16","LibrosComponent_div_23_Template_input_ngModelChange_20_listener","ctx_r17","LibrosComponent_div_23_Template_input_change_24_listener","ctx_r18","onFileSelected","ctx_r3","LibrosComponent","constructor","libroService","reservaService","router","cdr","nombreBusqueda","mostrarFormulario","ngOnInit","obtenerLibros","obtenerTodosLosLibros","subscribe","console","log","error","buscarLibrosPorNombre","buscarLibrosPorTitulo","respuesta","Array","isArray","length","undefined","event","selectedFile","target","files","libro","usuarioId","id","libroIndex","findIndex","l","detectChanges","alert","mostrarFormularioAgregar","formData","FormData","append","Blob","JSON","stringify","type","crearLibro","push","_","ɵɵdirectiveInject","i1","LibroService","i2","ReservaService","i3","Router","ChangeDetectorRef","_2","selectors","decls","vars","consts","template","LibrosComponent_Template","rf","ctx","LibrosComponent_Template_input_ngModelChange_14_listener","LibrosComponent_Template_button_click_16_listener","LibrosComponent_Template_button_click_18_listener","LibrosComponent_div_20_Template","LibrosComponent_div_21_Template","LibrosComponent_div_22_Template","LibrosComponent_div_23_Template"],"sources":["C:\\Users\\Juanma\\Documents\\GitHub\\librotech\\src\\app\\componentes\\libros.component.ts","C:\\Users\\Juanma\\Documents\\GitHub\\librotech\\src\\app\\componentes\\libros.component.html"],"sourcesContent":["import { Component, OnInit, ChangeDetectorRef } from '@angular/core';\r\nimport { Libro } from '../model/libro.model';\r\nimport { LibroService } from '../services/libro.service';\r\nimport { ReservaService } from '../services/reserva.service';\r\nimport { Router } from '@angular/router';\r\n\r\n@Component({\r\n  selector: 'app-libros',\r\n  templateUrl: './libros.component.html'\r\n})\r\nexport class LibrosComponent implements OnInit {\r\n\r\n  libros: Libro[] = [];\r\n  nombreBusqueda: string = '';\r\n  libroBuscado: Libro | undefined;\r\n  mostrarFormulario: boolean = false;\r\n  nuevoLibro: Libro = new Libro(0, '', '', 0, '');\r\n  selectedFile!: File;\r\n\r\n  constructor(\r\n    private libroService: LibroService,\r\n    private reservaService: ReservaService,\r\n    private router: Router,\r\n    private cdr: ChangeDetectorRef // Inyecta ChangeDetectorRef\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n    this.obtenerLibros();\r\n  }\r\n\r\n  obtenerLibros(): void {\r\n    this.libroService.obtenerTodosLosLibros().subscribe(\r\n      libros => {\r\n        console.log('Todos los libros:', libros);\r\n        this.libros = libros;\r\n      },\r\n      error => {\r\n        console.error('Error al obtener todos los libros:', error);\r\n      }\r\n    );\r\n  }\r\n\r\n  buscarLibrosPorNombre(): void {\r\n    console.log('Buscando libros con el nombre:', this.nombreBusqueda);\r\n  \r\n    if (this.nombreBusqueda) {\r\n      this.libroService.buscarLibrosPorTitulo(this.nombreBusqueda).subscribe(\r\n        (respuesta: any) => {\r\n          const libros = Array.isArray(respuesta) ? respuesta : [respuesta];\r\n          console.log('Libros encontrados:', libros);\r\n  \r\n          if (libros.length > 0) {\r\n            this.libroBuscado = libros[0];\r\n            console.log('Libro buscado actualizado:', this.libroBuscado);\r\n          } else {\r\n            this.libroBuscado = undefined;\r\n            console.log('No se encontraron libros con el nombre:', this.nombreBusqueda);\r\n          }\r\n        },\r\n        error => {\r\n          console.error('Error al buscar libros por título:', error);\r\n        }\r\n      );\r\n    } else {\r\n      this.libroBuscado = undefined;\r\n      this.obtenerLibros();\r\n    }\r\n  }\r\n\r\n  onFileSelected(event: any): void {\r\n    this.selectedFile = event.target.files[0];\r\n  }\r\n\r\n  getImagenUrl(imagen: string): string {\r\n    return `http://localhost:8086/api/libros/images/${imagen}`;\r\n  }\r\n\r\n  reservarLibro(libro: Libro): void {\r\n    const usuarioId = 1; // Asigna el ID del usuario actualmente logueado\r\n    if (libro.ejemplaresDisponibles > 0) {\r\n      this.reservaService.reservarLibro(libro.id, usuarioId).subscribe(\r\n        () => {\r\n          // Actualiza el libro de la lista\r\n          const libroIndex = this.libros.findIndex(l => l.id === libro.id);\r\n          if (libroIndex !== -1) {\r\n            this.libros[libroIndex].ejemplaresDisponibles--;\r\n            // Fuerza la detección de cambios\r\n            this.cdr.detectChanges();\r\n          }\r\n        },\r\n        error => {\r\n          console.error('Error al reservar libro:', error);\r\n        }\r\n      );\r\n    } else {\r\n      alert(`No hay ejemplares disponibles para el libro ${libro.titulo}.`);\r\n    }\r\n  }\r\n\r\n  mostrarFormularioAgregar(): void {\r\n    this.mostrarFormulario = true;\r\n  }\r\n\r\n  cerrarFormularioAgregar(): void {\r\n    this.mostrarFormulario = false;\r\n  }\r\n  \r\n  volverALibros(): void {\r\n    this.libroBuscado = undefined;\r\n  }\r\n\r\n  agregarLibro(): void {\r\n    const formData: FormData = new FormData();\r\n    formData.append('libro', new Blob([JSON.stringify(this.nuevoLibro)], { type: 'application/json' }));\r\n    formData.append('imagen', this.selectedFile);\r\n  \r\n    this.libroService.crearLibro(formData).subscribe(\r\n      (libro: Libro) => {\r\n        this.libros.push(libro);\r\n        this.cerrarFormularioAgregar();\r\n      },\r\n      error => {\r\n        console.error('Error al agregar libro:', error);\r\n      }\r\n    );\r\n  }\r\n}\r\n","<!DOCTYPE html>\r\n<html lang=\"es\">\r\n<head>\r\n  <meta charset=\"UTF-8\">\r\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n  <title>Listado de Libros</title>\r\n  <!-- Bootstrap CSS -->\r\n  <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css\" rel=\"stylesheet\">\r\n  <style>\r\n    .modal {\r\n      display: flex;\r\n      justify-content: center;\r\n      align-items: center;\r\n      position: fixed;\r\n      top: 0;\r\n      left: 0;\r\n      width: 100%;\r\n      height: 100%;\r\n      background-color: rgba(0, 0, 0, 0.5);\r\n      z-index: 1000;\r\n    }\r\n\r\n    .modal-content {\r\n      background-color: white;\r\n      padding: 20px;\r\n      border-radius: 5px;\r\n      width: 500px;\r\n      max-width: 100%;\r\n    }\r\n\r\n    .close {\r\n      position: absolute;\r\n      top: 10px;\r\n      right: 20px;\r\n      font-size: 24px;\r\n      cursor: pointer;\r\n    }\r\n\r\n    .fondo-difuminado {\r\n      position: fixed;\r\n      top: 0;\r\n      left: 0;\r\n      width: 100%;\r\n      height: 100%;\r\n      background-color: rgba(0, 0, 0, 0.5);\r\n      z-index: 999;\r\n    }\r\n\r\n    .libro-cuadro {\r\n      position: fixed;\r\n      top: 50%;\r\n      left: 50%;\r\n      transform: translate(-50%, -50%);\r\n      background-color: white;\r\n      padding: 20px;\r\n      border-radius: 5px;\r\n      z-index: 1000;\r\n    }\r\n    .libro-imagen {\r\n    width: 100%; /* Ancho del contenedor */\r\n    height: 200px; /* Altura deseada para las imágenes */\r\n    object-fit: contain; /* La imagen se ajustará al tamaño del contenedor sin recortarla */\r\n}\r\n\r\n\r\n  </style>\r\n</head>\r\n<body>\r\n  <div class=\"container mt-4 libro-container\">\r\n    <h2>Listado de Libros</h2>\r\n  \r\n    <div class=\"mb-3\">\r\n      <label for=\"nombreBusqueda\" class=\"form-label\">Buscar:</label>\r\n      <input type=\"text\" id=\"nombreBusqueda\" [(ngModel)]=\"nombreBusqueda\" class=\"form-control\">\r\n      <div class=\"d-flex justify-content-between mt-2\">\r\n        <button class=\"btn btn-primary\" (click)=\"buscarLibrosPorNombre()\">Buscar</button>\r\n        <button class=\"btn btn-success\" (click)=\"mostrarFormularioAgregar()\">Agregar Libro</button>\r\n      </div>\r\n    </div>\r\n\r\n<!-- Vista HTML para mostrar la información de un libro -->\r\n<div *ngIf=\"libroBuscado\">\r\n  <div class=\"fondo-difuminado\"></div>\r\n  <div class=\"libro-cuadro\">\r\n      <h3>{{ libroBuscado.titulo }}</h3>\r\n      <p>Autor: {{ libroBuscado.autor }}</p>\r\n      <p>Ejemplares disponibles: {{ libroBuscado.ejemplaresDisponibles }}</p>\r\n      <!-- Mostrar la imagen del libro -->\r\n      <img [src]=\"getImagenUrl(libroBuscado.imagen)\" alt=\"{{ libroBuscado.titulo }}\" class=\"img-fluid\">\r\n      <button class=\"btn btn-primary\" (click)=\"reservarLibro(libroBuscado)\">Reservar</button>\r\n      <button class=\"btn btn-secondary\" (click)=\"volverALibros()\">Volver a la lista</button>\r\n  </div>\r\n</div>\r\n\r\n<div class=\"row\" *ngIf=\"libros.length > 0\">\r\n  <div class=\"col-md-4 mb-4\" *ngFor=\"let libro of libros\">\r\n      <div class=\"card h-100 card-libro\">\r\n          <img [src]=\"'http://localhost:8086/api/libros/images/' + libro.imagen\" class=\"card-img-top libro-imagen\" alt=\"{{ libro.titulo }}\">\r\n          <div class=\"card-body\">\r\n              <h5 class=\"card-title\">{{ libro.titulo }}</h5>\r\n              <p class=\"card-text\">Autor: {{ libro.autor }}</p>\r\n              <p class=\"card-text\">Ejemplares Disponibles: {{ libro.ejemplaresDisponibles }}</p>\r\n              <button class=\"btn btn-primary\" (click)=\"reservarLibro(libro)\">Reservar</button>\r\n          </div>\r\n      </div>\r\n  </div>\r\n</div>\r\n\r\n\r\n\r\n  \r\n    <div *ngIf=\"!libros.length\">\r\n      <p>No se encontraron libros.</p>\r\n    </div>\r\n  \r\n    <div *ngIf=\"mostrarFormulario\">\r\n      <div class=\"fondo-difuminado\" (click)=\"cerrarFormularioAgregar()\"></div>\r\n      <div class=\"modal\">\r\n        <div class=\"modal-content\">\r\n          <span class=\"close\" (click)=\"cerrarFormularioAgregar()\">&times;</span>\r\n          <h2>Agregar Nuevo Libro</h2>\r\n          <form (ngSubmit)=\"agregarLibro()\">\r\n            <div class=\"mb-3\">\r\n              <label for=\"titulo\" class=\"form-label\">Título</label>\r\n              <input type=\"text\" class=\"form-control\" id=\"titulo\" [(ngModel)]=\"nuevoLibro.titulo\" name=\"titulo\" required>\r\n            </div>\r\n            <div class=\"mb-3\">\r\n              <label for=\"autor\" class=\"form-label\">Autor</label>\r\n              <input type=\"text\" class=\"form-control\" id=\"autor\" [(ngModel)]=\"nuevoLibro.autor\" name=\"autor\" required>\r\n            </div>\r\n            <div class=\"mb-3\">\r\n              <label for=\"ejemplares\" class=\"form-label\">Ejemplares Disponibles</label>\r\n              <input type=\"number\" class=\"form-control\" id=\"ejemplares\" [(ngModel)]=\"nuevoLibro.ejemplaresDisponibles\" name=\"ejemplares\" required>\r\n            </div>\r\n            <div class=\"mb-3\">\r\n              <label for=\"imagen\" class=\"form-label\">Imagen</label>\r\n              <input type=\"file\" class=\"form-control\" id=\"imagen\" (change)=\"onFileSelected($event)\">\r\n            </div>\r\n            <button type=\"submit\" class=\"btn btn-primary\">Agregar</button>\r\n          </form>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</body>\r\n</html>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}