{"ast":null,"code":"import { Reserva } from '../model/reserva.model';\nimport { Libro } from '../model/libro.model';\nimport { User } from '../model/user.model';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../services/reserva.service\";\nimport * as i2 from \"@angular/common\";\nfunction ReservaComponent_tr_19_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r3 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"td\");\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"td\");\n    i0.ɵɵtext(10);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"td\")(12, \"button\", 4);\n    i0.ɵɵlistener(\"click\", function ReservaComponent_tr_19_Template_button_click_12_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r3);\n      const reserva_r1 = restoredCtx.$implicit;\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.devolverLibro(reserva_r1.id));\n    });\n    i0.ɵɵtext(13, \"Libro devuelto\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const reserva_r1 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(reserva_r1.id);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(reserva_r1.libro.autor);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(reserva_r1.usuario.username);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(reserva_r1.fechaReserva);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(reserva_r1.fechaDevolucion);\n  }\n}\nexport class ReservaComponent {\n  constructor(reservaService) {\n    this.reservaService = reservaService;\n    this.reservas = [];\n    this.nuevaReserva = new Reserva(0, new Libro(0, '', '', 0, ''), new User(0, '', '', ''), new Date(), new Date());\n  }\n  ngOnInit() {\n    this.obtenerReservas();\n  }\n  obtenerReservas() {\n    this.reservaService.obtenerReservas().subscribe(data => {\n      this.reservas = data;\n    });\n  }\n  crearReserva(libroId, usuarioId) {\n    this.reservaService.crearReserva(libroId, usuarioId).subscribe(() => {\n      this.obtenerReservas();\n      this.snackBar.open('Reserva creada exitosamente.', 'Cerrar', {\n        duration: 3000\n      });\n    }, error => {\n      this.snackBar.open(error.error, 'Cerrar', {\n        duration: 3000\n      });\n    });\n  }\n  eliminarReserva(reservaId) {\n    this.reservaService.eliminarReserva(reservaId).subscribe(() => {\n      // Si la eliminación tiene éxito, incrementa el contador de ejemplares disponibles\n      this.libro.ejemplaresDisponibles++;\n      // Actualiza la interfaz de usuario para reflejar el cambio\n      this.actualizarContadorEjemplaresDisponibles();\n      // Muestra un mensaje de éxito\n      this.alertService.mostrarMensaje('Reserva eliminada correctamente.');\n    }, error => {\n      // Manejar errores\n      console.error('Error al eliminar la reserva:', error);\n    });\n  }\n  devolverLibro(reservaId) {\n    this.reservaService.devolverLibro(reservaId).subscribe(() => {\n      this.libro.ejemplaresDisponibles++;\n      this.actualizarContadorEjemplaresDisponibles();\n      this.alertService.mostrarMensaje('Libro devuelto correctamente.');\n      this.reservas = this.reservas.filter(reserva => reserva.id !== reservaId);\n    }, error => {\n      console.error('Error al devolver el libro:', error);\n    });\n  }\n  actualizarContadorEjemplaresDisponibles() {\n    // Lógica para actualizar el contador en la interfaz de usuario\n  }\n  static #_ = this.ɵfac = function ReservaComponent_Factory(t) {\n    return new (t || ReservaComponent)(i0.ɵɵdirectiveInject(i1.ReservaService));\n  };\n  static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ReservaComponent,\n    selectors: [[\"app-reserva\"]],\n    decls: 20,\n    vars: 1,\n    consts: [[1, \"container\", \"mt-5\"], [1, \"mt-4\"], [1, \"table\", \"table-striped\"], [4, \"ngFor\", \"ngForOf\"], [1, \"btn\", \"btn-success\", \"btn-sm\", 3, \"click\"]],\n    template: function ReservaComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"h1\", 1);\n        i0.ɵɵtext(2, \"Lista de Reservas\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(3, \"table\", 2)(4, \"thead\")(5, \"tr\")(6, \"th\");\n        i0.ɵɵtext(7, \"ID\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(8, \"th\");\n        i0.ɵɵtext(9, \"ID del Libro\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(10, \"th\");\n        i0.ɵɵtext(11, \"ID del Usuario\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(12, \"th\");\n        i0.ɵɵtext(13, \"Fecha de Reserva\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(14, \"th\");\n        i0.ɵɵtext(15, \"Fecha de Devolucion\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(16, \"th\");\n        i0.ɵɵtext(17, \"Acciones\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(18, \"tbody\");\n        i0.ɵɵtemplate(19, ReservaComponent_tr_19_Template, 14, 5, \"tr\", 3);\n        i0.ɵɵelementEnd()()();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(19);\n        i0.ɵɵproperty(\"ngForOf\", ctx.reservas);\n      }\n    },\n    dependencies: [i2.NgForOf],\n    encapsulation: 2\n  });\n}","map":{"version":3,"names":["Reserva","Libro","User","i0","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","ɵɵlistener","ReservaComponent_tr_19_Template_button_click_12_listener","restoredCtx","ɵɵrestoreView","_r3","reserva_r1","$implicit","ctx_r2","ɵɵnextContext","ɵɵresetView","devolverLibro","id","ɵɵadvance","ɵɵtextInterpolate","libro","autor","usuario","username","fechaReserva","fechaDevolucion","ReservaComponent","constructor","reservaService","reservas","nuevaReserva","Date","ngOnInit","obtenerReservas","subscribe","data","crearReserva","libroId","usuarioId","snackBar","open","duration","error","eliminarReserva","reservaId","ejemplaresDisponibles","actualizarContadorEjemplaresDisponibles","alertService","mostrarMensaje","console","filter","reserva","_","ɵɵdirectiveInject","i1","ReservaService","_2","selectors","decls","vars","consts","template","ReservaComponent_Template","rf","ctx","ɵɵtemplate","ReservaComponent_tr_19_Template","ɵɵproperty"],"sources":["C:\\Users\\Juanma\\Documents\\GitHub\\librotech\\src\\app\\componentes\\reserva.component.ts","C:\\Users\\Juanma\\Documents\\GitHub\\librotech\\src\\app\\componentes\\reserva.component.html"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\r\nimport { ReservaService } from '../services/reserva.service';\r\nimport { Reserva } from '../model/reserva.model';\r\nimport { Libro } from '../model/libro.model';\r\nimport { User } from '../model/user.model';\r\n\r\n@Component({\r\n  selector: 'app-reserva',\r\n  templateUrl: './reserva.component.html'\r\n})\r\nexport class ReservaComponent implements OnInit {\r\n  reservas: Reserva[] = [];\r\n  nuevaReserva: Reserva = new Reserva(\r\n    0, \r\n    new Libro(0, '', '', 0, ''), \r\n    new User(0, '', '',''), \r\n    new Date(), \r\n    new Date());\r\n  alertService: any;\r\n  libro: any;\r\n  snackBar: any;\r\n\r\n  constructor(private reservaService: ReservaService) {}\r\n\r\n  ngOnInit() {\r\n    this.obtenerReservas();\r\n  }\r\n\r\n  obtenerReservas() {\r\n    this.reservaService.obtenerReservas().subscribe(data => {\r\n      this.reservas = data;\r\n    });\r\n  }\r\n\r\n  crearReserva(libroId: number, usuarioId: number): void {\r\n    this.reservaService.crearReserva(libroId, usuarioId).subscribe(\r\n      () => {\r\n        this.obtenerReservas();\r\n        this.snackBar.open('Reserva creada exitosamente.', 'Cerrar', { duration: 3000 });\r\n      },\r\n      error => {\r\n        this.snackBar.open(error.error, 'Cerrar', { duration: 3000 });\r\n      }\r\n    );\r\n  }\r\n  \r\n  eliminarReserva(reservaId: number): void {\r\n    this.reservaService.eliminarReserva(reservaId).subscribe(\r\n      () => {\r\n        // Si la eliminación tiene éxito, incrementa el contador de ejemplares disponibles\r\n        this.libro.ejemplaresDisponibles++;\r\n        // Actualiza la interfaz de usuario para reflejar el cambio\r\n        this.actualizarContadorEjemplaresDisponibles();\r\n        // Muestra un mensaje de éxito\r\n        this.alertService.mostrarMensaje('Reserva eliminada correctamente.');\r\n      },\r\n      error => {\r\n        // Manejar errores\r\n        console.error('Error al eliminar la reserva:', error);\r\n      }\r\n    );\r\n  }\r\n\r\n  devolverLibro(reservaId: number): void {\r\n    this.reservaService.devolverLibro(reservaId).subscribe(\r\n      () => {\r\n        this.libro.ejemplaresDisponibles++;\r\n        this.actualizarContadorEjemplaresDisponibles();\r\n        this.alertService.mostrarMensaje('Libro devuelto correctamente.');\r\n        this.reservas = this.reservas.filter(reserva => reserva.id !== reservaId);\r\n      },\r\n      error => {\r\n        console.error('Error al devolver el libro:', error);\r\n      }\r\n    );\r\n  }\r\n\r\n  actualizarContadorEjemplaresDisponibles(): void {\r\n    // Lógica para actualizar el contador en la interfaz de usuario\r\n  }\r\n\r\n}\r\n","<div class=\"container mt-5\">\r\n  <h1 class=\"mt-4\">Lista de Reservas</h1>\r\n  <table class=\"table table-striped\">\r\n    <thead>\r\n      <tr>\r\n        <th>ID</th>\r\n        <th>ID del Libro</th>\r\n        <th>ID del Usuario</th>\r\n        <th>Fecha de Reserva</th>\r\n        <th>Fecha de Devolucion</th>\r\n        <th>Acciones</th>\r\n      </tr>\r\n    </thead>\r\n    <tbody>\r\n      <tr *ngFor=\"let reserva of reservas\">\r\n        <td>{{ reserva.id }}</td>\r\n        <td>{{ reserva.libro.autor}}</td>\r\n        <td>{{ reserva.usuario.username }}</td>\r\n        <td>{{ reserva.fechaReserva }}</td>\r\n        <td>{{ reserva.fechaDevolucion}}</td>\r\n        <td>\r\n          <button class=\"btn btn-success btn-sm\" (click)=\"devolverLibro(reserva.id)\">Libro devuelto</button>\r\n        </td>\r\n      </tr>\r\n    </tbody>\r\n  </table>\r\n</div>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}